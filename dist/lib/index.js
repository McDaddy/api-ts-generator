"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("axios"),r=require("query-string"),t=require("path-to-regexp");function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=o(e),s=o(r);const a=/^http(s)?:\/\/(.*?)\//,l=["GET","POST","PUT","DELETE"];let c={};const u=(e,r)=>{try{let o="";const n=new RegExp(a).exec(e);n&&([o]=n);return`${o}${t.compile(e.replace(a,""))(r)}`}catch(r){throw console.error("path:",e,"Error parsing url parameters"),r}},p=function(e){const{api:r,method:o="GET",successMsg:p}=e,i=o.toUpperCase();if(!l.includes(i))throw new Error(`Invalid method: ${o}`);return e=>{const l=e||{},{$options:d,$body:y}=l,f=function(e,r){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&r.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)r.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(t[o[n]]=e[o[n]])}return t}(l,["$options","$body"]),{bodyOrQuery:h,pathParams:g}=((e,r)=>{const o=[];t.pathToRegexp(e.replace(a,"/"),o);const n={},s=Object.assign({},r);return o.length>0&&o.forEach((({name:e})=>{n[e]=s[e],delete s[e]})),{pathParams:n,bodyOrQuery:s}})(r,f),{isDownload:b,uploadFileKey:O,rawResponse:v,onUploadProgress:P}=d||{};let m,E=h;return["POST","PUT"].includes(i)?(Object.keys(h).length&&(m=O?h[O]:h),E={}):"DELETE"===i&&(m=y),n.default({method:o,url:u(r,g),params:E,paramsSerializer:e=>s.default.stringify(e),responseType:b?"blob":"json",data:m,onUploadProgress:P}).then((e=>{var r;return v?e:["POST","PUT"].includes(i)?(c.onSuccess&&"function"==typeof c.onSuccess&&(null!=p?p:null==d?void 0:d.successMsg)&&c.onSuccess(null!=p?p:null==d?void 0:d.successMsg),null==e?void 0:e.data):null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.data})).catch((e=>{throw console.error("api err: ",e),e}))}};function i(e){return p(e)}exports.apiCreator=i,exports.default=i,exports.genRequest=p,exports.initApiGenerator=e=>{c=e};
